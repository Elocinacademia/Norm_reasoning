

action_list =[['send', 'spa', 'skills', '_', '_', 'primary_user', 'with the purpose of knowing the data'], ['send', 'spa', 'house keeper', '_', '_', 'primary_user', 'with the purpose of knowing the data'], ['send', 'spa', 'assistant provider', '_', '_', 'primary_user', '_'], ['send', 'spa', '_', 'smart_camera', 'smart camera', 'primary_user', 'with the purpose of knowing the data'], ['send', 'spa', 'skills', '_', '_', 'primary_user', 'with the purpose of knowing the data'], ['send', 'spa', '_', 'to_do', 'to do list', 'primary_user', '_'], ['send', 'spa', '_', 'to_do', 'to do list', 'primary_user', 'with the purpose of knowing the data'], ['send', 'spa', '_', 'sleep_aid', 'sleeping hours', 'primary_user', '_'], ['send', 'spa', 'close friends', '_', '_', 'primary_user', 'with the purpose of knowing the data'], ['send', 'spa', '_', 'playlists', 'playlists', 'primary_user', 'with the purpose of knowing the data'], ['send', 'spa', 'skills', '_', '_', 'primary_user', 'with the purpose of knowing the data'], ['send', 'spa', '_', 'video_calls', 'video call', 'primary_user', '_'], ['send', 'spa', 'skills', 'to_do', 'to do list', 'primary_user', '_'], ['send', 'spa', 'housemates', '_', '_', 'primary_user', 'with the purpose of knowing the data'], ['send', 'spa', 'skills', '_', '_', 'primary_user', '_'], ['send', 'spa', 'house keeper', '_', '_', 'primary_user', '_'], ['send', 'spa', 'skills', 'voice_recordings', 'voice recording', 'primary_user', '_'], ['send', 'spa', 'assistant provider', '_', '_', 'primary_user', 'with the purpose of knowing the data'], ['send', 'spa', 'skills', 'banking', 'banking', 'primary_user', '_'], ['send', 'spa', 'parents', '_', '_', 'primary_user', '_'], ['send', 'spa', 'skills', '_', '_', 'primary_user', 'with the purpose of knowing the data'], ['send', 'spa', 'skills', 'call_assistant', 'call assistant', 'primary_user', '_'], ['send', 'spa', 'skills', '_', '_', 'primary_user', 'with the purpose of knowing the data'], ['send', 'spa', '_', 'playlists', 'playlists', 'primary_user', '_'], ['send', 'spa', 'skills', 'video_calls', 'video call', 'primary_user', '_'], ['send', 'spa', '_', 'voice_recordings', 'voice recording', 'primary_user', 'with the purpose of knowing the data'], ['send', 'spa', 'law enforcement agencies', '_', '_', 'primary_user', 'with the purpose of knowing the data'], ['send', 'spa', 'skills', 'playlists', 'playlists', 'primary_user', '_'], ['send', 'spa', '_', 'sleep_aid', 'sleeping hours', 'primary_user', 'with the purpose of knowing the data'], ['send', 'spa', '_', 'call_assistant', 'call assistant', 'primary_user', '_'], ['send', 'spa', 'siblings', '_', '_', 'primary_user', 'with the purpose of knowing the data'], ['send', 'spa', '_', 'call_assistant', 'call assistant', 'primary_user', 'with the purpose of knowing the data'], ['send', 'spa', 'close family', '_', '_', 'primary_user', 'with the purpose of knowing the data'], ['send', 'spa', '_', 'weather_forecast', 'weather', 'primary_user', 'with the purpose of knowing the data'], ['send', 'spa', 'children', '_', '_', 'primary_user', '_'], ['send', 'spa', 'advertising agencies', '_', '_', 'primary_user', 'with the purpose of knowing the data'], ['send', 'spa', 'assistant provider', '_', '_', 'primary_user', 'with the purpose of knowing the data'], ['send', 'spa', 'law enforcement agencies', '_', '_', 'primary_user', 'with the purpose of knowing the data'], ['send', 'spa', 'law enforcement agencies', '_', '_', 'primary_user', 'with the purpose of knowing the data'], ['send', 'spa', 'skills', 'weather_forecast', 'weather', 'primary_user', '_'], ['send', 'spa', 'advertising agencies', '_', '_', 'primary_user', 'with the purpose of knowing the data'], ['send', 'spa', 'assistant provider', '_', '_', 'primary_user', 'with the purpose of knowing the data'], ['send', 'spa', 'law enforcement agencies', '_', '_', 'primary_user', 'with the purpose of knowing the data'], ['send', 'spa', '_', 'voice_recordings', 'voice recording', 'primary_user', '_'], ['send', 'spa', 'parents', '_', '_', 'primary_user', 'with the purpose of knowing the data'], ['send', 'spa', 'advertising agencies', '_', '_', 'primary_user', 'with the purpose of knowing the data'], ['send', 'spa', 'law enforcement agencies', '_', '_', 'primary_user', 'with the purpose of knowing the data'], ['send', 'spa', 'children', '_', '_', 'primary_user', 'with the purpose of knowing the data'], ['send', 'spa', 'law enforcement agencies', '_', '_', 'primary_user', 'with the purpose of knowing the data'], ['send', 'spa', 'advertising agencies', '_', '_', 'primary_user', 'with the purpose of knowing the data'], ['send', 'spa', '_', 'weather_forecast', 'weather', 'primary_user', '_'], ['send', 'spa', '_', 'email', 'email', 'primary_user', 'with the purpose of knowing the data'], ['send', 'spa', 'assistant provider', '_', '_', 'primary_user', 'with the purpose of knowing the data'], ['send', 'spa', 'assistant provider', '_', '_', 'primary_user', 'with the purpose of knowing the data'], ['send', 'spa', 'neighbours', '_', '_', 'primary_user', 'with the purpose of knowing the data'], ['send', 'spa', 'assistant provider', '_', '_', 'primary_user', 'with the purpose of knowing the data'], ['send', 'spa', 'advertising agencies', 'to_do', 'to do list', 'primary_user', '_'], ['send', 'spa', 'visitors in general', '_', '_', 'primary_user', 'with the purpose of knowing the data'], ['send', 'spa', 'skills', '_', '_', 'primary_user', 'with the purpose of knowing the data'], ['send', 'spa', '_', 'banking', 'banking', 'primary_user', '_'], ['send', 'spa', '_', 'email', 'email', 'primary_user', '_'], ['send', 'spa', '_', 'banking', 'banking', 'primary_user', 'with the purpose of knowing the data'], ['send', 'spa', 'advertising agencies', '_', '_', 'primary_user', 'with the purpose of knowing the data'], ['send', 'spa', 'visitors in general', '_', '_', 'primary_user', '_'], ['send', 'spa', 'neighbours', '_', '_', 'primary_user', '_'], ['send', 'spa', 'partner', '_', '_', 'primary_user', '_'], ['send', 'spa', 'partner', '_', '_', 'primary_user', 'with the purpose of knowing the data'], ['send', 'spa', 'advertising agencies', '_', '_', 'primary_user', 'with the purpose of knowing the data'], ['send', 'spa', 'advertising agencies', '_', '_', 'primary_user', '_'], ['send', 'spa', 'skills', '_', '_', 'primary_user', '_'], ['send', 'spa', '_', 'to_do', 'to do list', 'primary_user', '_'], ['send', 'spa', '_', 'smart_door_locker', 'door locker', 'primary_user', '_'], ['send', 'spa', 'close friends', '_', '_', 'primary_user', '_'], ['send', 'spa', '_', 'healthcare', 'healthcare', 'primary_user', '_'], ['send', 'spa', '_', 'sleep_aid', 'sleeping hours', 'primary_user', '_'], ['send', 'spa', '_', 'ride_service', 'location', 'primary_user', '_'], ['send', 'spa', '_', 'online_shopping', 'shopping', 'primary_user', '_'], ['send', 'spa', 'housemates', '_', '_', 'primary_user', '_'], ['send', 'spa', '_', 'smart_camera', 'smart camera', 'primary_user', '_'], ['send', 'spa', 'house keeper', '_', '_', 'primary_user', '_'], ['send', 'spa', '_', 'video_calls', 'video call', 'primary_user', '_'], ['send', 'spa', '_', 'smart_thermostat', 'thermostat', 'primary_user', '_'], ['send', 'spa', '_', 'voice_recordings', 'voice recording', 'primary_user', '_'], ['send', 'spa', '_', 'call_assistant', 'call assistant', 'primary_user', '_'], ['send', 'spa', 'assistant provider', '_', '_', 'primary_user', '_'], ['send', 'spa', 'law enforcement agencies', '_', '_', 'primary_user', '_'], ['send', 'spa', 'siblings', '_', '_', 'primary_user', '_'], ['send', 'spa', 'close family', '_', '_', 'primary_user', '_'], ['send', 'spa', '_', 'playlists', 'playlists', 'primary_user', '_'], ['send', 'spa', '_', 'email', 'email', 'primary_user', '_'], ['send', 'spa', 'parents', '_', '_', 'primary_user', '_'], ['send', 'spa', '_', 'banking', 'banking', 'primary_user', '_'], ['send', 'spa', 'children', '_', '_', 'primary_user', '_'], ['send', 'spa', '_', 'weather_forecast', 'weather', 'primary_user', '_'], ['send', 'spa', 'advertising agencies', '_', '_', 'primary_user', '_'], ['send', 'spa', 'neighbours', '_', '_', 'primary_user', '_'], ['send', 'spa', 'visitors in general', '_', '_', 'primary_user', '_'], ['send', 'spa', 'partner', '_', '_', 'primary_user', '_']]
sentences = ['The assistant is sending call assistant of primary_user to skills without stating purpose', 'The assistant is sending call assistant of primary_user without stating purpose', 'The assistant is sending call assistant of primary_user with the purpose of knowing the data']

# sentences = []
# for item in sentence_collection:
#     item = '_'.join(item.split())
#     item = item.split('_')
#     sentences.append(item)
# now sentences is equal to tokenized_sent

import numpy as np

def cosine(u, v):
    return np.dot(u, v) / (np.linalg.norm(u) * np.linalg.norm(v))




# import nltk
# nltk.download('punkt')
# from nltk.tokenize import word_tokenize


# sentences = ["I ate dinner.", 
#    "We had a three-course meal.", 
#    "Brad came to dinner with us.",
#    "He loves fish tacos.",
#    "In the end, we all felt like we ate too much.",
#    "We all agreed; it was a magnificent evening."]

# Tokenization of each document
# tokenized_sent = []
# for s in sentences:
#     tokenized_sent.append(word_tokenize(s.lower()))
# print(tokenized_sent)



from sentence_transformers import SentenceTransformer
sbert_model = SentenceTransformer('bert-base-nli-mean-tokens')
sentence_embeddings = sbert_model.encode(sentences)

print('Sample BERT embedding vector - length', len(sentence_embeddings[0]))
print('Sample BERT embedding vector - note includes negative values', sentence_embeddings[0])

query = "I had pizza and pasta"
query_vec = sbert_model.encode([query])[0]

sim_value = []
for sent in sentences:
    # import pdb; pdb.set_trace()
    sim = cosine(query_vec, sbert_model.encode([sent])[0])
    sim_value.append(sim)
    print("Sentence = ", sent, "; similarity = ", sim)
index = sim_value.index(max(sim_value))
print(index, sim_value[index])



